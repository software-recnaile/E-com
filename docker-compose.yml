version: "3.9"

services:
  apache:
    build: ./apache
    container_name: apache
    ports:
      - "80:80"     # HTTP → Redirects to HTTPS
      - "443:443"   # HTTPS main site
    volumes:
      # Mount your Apache config
      - ./apache/conf:/usr/local/apache2/conf/extra:ro

      # Mount Let's Encrypt certs from host → container (required for SSL)
      - /etc/letsencrypt:/etc/letsencrypt:ro

    depends_on:
      - authservice
      - accountservice
      - productservice
      - cartservice
      - wishlistservice
      - profile
      - bulkorderservice
      - address
      - mailservice

    environment:
      - Tech2025=default_value

    networks:
      - recnaile-net

  authservice:
    build: ./authService
    container_name: authservice
    expose:
      - "8081"
    environment:
      - Tech2025=default_value
    networks:
      - recnaile-net

  accountservice:
    build: ./accountService
    container_name: accountservice
    expose:
      - "8082"
    environment:
      - Tech2025=default_value
    networks:
      - recnaile-net

  productservice:
    build: ./productService
    container_name: productservice
    expose:
      - "8083"
    environment:
      - Tech2025=default_value
    networks:
      - recnaile-net

  cartservice:
    build: ./cartService
    container_name: cartservice
    expose:
      - "8084"
    environment:
      - Tech2025=default_value
    networks:
      - recnaile-net

  wishlistservice:
    build: ./wishlistService
    container_name: wishlistservice
    expose:
      - "8085"
    environment:
      - Tech2025=default_value
    networks:
      - recnaile-net

  profile:
    build: ./profile
    container_name: profile
    expose:
      - "8086"
    environment:
      - Tech2025=default_value
    networks:
      - recnaile-net

  bulkorderservice:
    build: ./bulkorderservice
    container_name: bulkorderservice
    expose:
      - "8087"
    environment:
      - Tech2025=default_value
    networks:
      - recnaile-net

  address:
    build: ./address
    container_name: address
    expose:
      - "8088"
    environment:
      - Tech2025=default_value
    networks:
      - recnaile-net

  mailservice:
    build: ./mailService
    container_name: mailservice
    expose:
      - "8089"
    environment:
      - Tech2025=default_value
    networks:
      - recnaile-net

networks:
  recnaile-net:
    driver: bridge
